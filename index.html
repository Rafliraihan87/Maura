<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EPPGBM — Full Demo</title>

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>


  <style>
    :root{
      --card-bg:#f8f9fa;
      --info-grad: linear-gradient(90deg,#aee1ff,#d2f3ff);
    }
    body{font-family: Poppins, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; padding-bottom:90px; background:#fff; overflow-x: hidden;}
    .top-bar{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
    .menu-card{background:var(--card-bg);border-radius:12px;padding:14px;text-align:center;cursor:pointer}
    .balita-card{background:#fff;border-radius:10px;padding:12px;margin-bottom:10px;box-shadow:0 1px 3px rgba(0,0,0,.06)}
    .info-box{background:var(--info-grad);border-radius:10px;padding:12px;color:#fff}
    .bottom-nav{position:fixed;bottom:0;left:0;width:100%;background:#fff;border-top:1px solid #ddd;display:flex;justify-content:space-around;padding:8px;z-index:1000}
    .badge-status-b{background:#198754;color:#fff;border-radius:6px;padding:4px 8px;font-size:12px}
    .badge-status-k{background:#ffc107;color:#222;border-radius:6px;padding:4px 8px;font-size:12px}
    .badge-status-r{background:#dc3545;color:#fff;border-radius:6px;padding:4px 8px;font-size:12px}
    .kms-legend {display:flex;gap:8px;align-items:center;justify-content:center;margin-top:6px}
    .kms-legend span{display:inline-block;padding:4px 8px;border-radius:6px;font-size:12px}
    /* login screen */
    #loginScreen {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  opacity: 0;
  transition: opacity 0.6s ease;
  
  /* Animasi Latar Belakang */
  background: linear-gradient(-45deg, #e0f7fa, #b2ebf2, #80deea, #4dd0e1);
  background-size: 400% 400%;
  animation: gradientBG 15s ease infinite;
}

@keyframes gradientBG {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
#loginBox {
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
  padding: 28px;
  border-radius: 16px;
  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
  width: 92%;
  max-width: 420px;
  transform: translateY(18px);
  animation: up .7s ease forwards;
}

#loginBox .form-control {
  border-radius: 8px;
  padding: 10px;
  border: 1px solid #ddd;
  background-color: #f8f9fa;
}

#loginBox .form-control:focus {
  background-color: #fff;
  border-color: #86b7fe;
  box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
}

#loginBox .btn {
  padding: 12px;
  border-radius: 8px;
  font-weight: 600;
  transition: background-color 0.2s ease;
}
    #loginScreen.visible{opacity:1}
    #loginBox{background:#fff;padding:22px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.08);width:92%;max-width:420px;transform:translateY(18px);animation:up .7s ease forwards}
    @keyframes up{from{opacity:0;transform:translateY(28px)}to{opacity:1;transform:translateY(0)}}
    /* small screens for modal full */
    @media (min-width:768px){ .container{max-width:720px} }
    /* CSS untuk Legenda Donut Chart */
/* CSS untuk Legenda Donut Chart (HORIZONTAL) */
.legend-item-horiz {
  padding: 6px 4px;
  background: rgba(255,255,255,0.3);
  border-radius: 6px;
}
.legend-label {
  display: flex;
  align-items: center;
  justify-content: center; /* Posisikan di tengah */
  font-size: 12px;
  font-weight: 500;
  color: #004d40;
}
.legend-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  margin-right: 5px;
  flex-shrink: 0;
}
.legend-value {
  font-size: 14px;
  font-weight: 700;
  color: #004d40;
  margin-top: 2px;
}
/* CSS untuk Kategori dan CAROUSEL */
.category-section {
  margin-top: 20px;
}
.category-title {
  font-weight: 600;
  margin-bottom: 8px;
  padding-left: 4px;
}
.carousel-wrapper {
  overflow: hidden; /* Menyembunyikan card yang di luar view */
  position: relative;
}
.carousel-track {
  display: flex;
  gap: 10px;
  /* Transisi ini yang membuat pergeseran menjadi mulus */
  transition: transform 0.5s ease-in-out; 
}
.carousel-track .balita-card {
  width: 360px; /* Lebar tetap untuk setiap kartu */
  flex-shrink: 0; /* Mencegah kartu menyusut */
}
.empty-state-category {
  background: var(--card-bg);
  border-radius: 12px;
  padding: 30px 14px;
  text-align: center;
  color: #888;
  font-size: 14px;
}
.card-info-block {
  flex: 1; /* Ini akan membuatnya mengisi ruang kosong */
  min-width: 0; /* Trik untuk mencegah teks aneh di flexbox */
  padding-right: 10px; /* Beri sedikit jarak dari tombol */
}
/* === DARK MODE STYLES === */
body.dark-mode {
  --card-bg: #2b2b2b;
  --info-grad: linear-gradient(90deg, #0d47a1, #1565c0);
  background: #1e1e1e;
  color: #e0e0e0;
}

body.dark-mode .menu-card,
body.dark-mode .balita-card,
body.dark-mode .modal-content,
body.dark-mode .empty-state-category {
  background: var(--card-bg);
  border-color: #444;
  color: #e0e0e0;
}

body.dark-mode .form-control {
  background-color: #333;
  border-color: #555;
  color: #fff;
}

body.dark-mode .form-control::placeholder {
  color: #888;
}

body.dark-mode .bottom-nav {
  background: #2b2b2b;
  border-top-color: #444;
}

body.dark-mode .badge-status-k {
  color: #fff;
  background: #b48500;
}

body.dark-mode .kms-legend span,
body.dark-mode .legend-item-horiz {
  background: rgba(0, 0, 0, 0.2);
}

body.dark-mode .legend-label,
body.dark-mode .legend-value {
  color: #b3e5fc;
}
/* ======================== */
.info-box {
  position: relative; /* Penting untuk layering */
  overflow: hidden; /* Agar ikon tidak keluar dari kotak */
}
#iconAnimationArea {
  position: absolute;
  inset: 0; /* Memenuhi seluruh area info-box */
  z-index: 0; /* Posisikan di lapisan paling bawah */
}
.info-box-content {
  position: relative;
  z-index: 1; /* Posisikan konten di atas animasi */
}
/* === CSS BARU UNTUK ANIMASI GELEMBUNG === */
.animated-icon {
  position: absolute;
  color: rgba(0, 0, 0, 0.9); /* <-- Opasitas dinaikkan dari 0.1 menjadi 0.2 */
  animation-timing-function: ease-in-out;
  animation-iteration-count: infinite;
}

/* Terapkan animasi berbeda untuk ikon ganjil dan genap */
.animated-icon:nth-child(odd) {
  animation-name: bubble-move-1;
}
.animated-icon:nth-child(even) {
  animation-name: bubble-move-2;
}

/* Perbaikan Warna Teks di Dark Mode */
body.dark-mode .balita-card {
  color: #f8f9fa; /* Warna teks utama menjadi hampir putih */
}
body.dark-mode .balita-card .text-muted {
  color: #adb5bd !important; /* Warna untuk teks sekunder (info ibu, umur, dll) */
}

/* Jalur animasi pertama (seperti persegi) */
@keyframes bubble-move-1 {
  0%, 100% { transform: translate(0, 0); }
  25% { transform: translate(30px, -20px); }
  50% { transform: translate(50px, 25px); }
  75% { transform: translate(-10px, 40px); }
}

/* Jalur animasi kedua (berbeda arah) */
@keyframes bubble-move-2 {
  0%, 100% { transform: translate(0, 0); }
  25% { transform: translate(-25px, 30px); }
  50% { transform: translate(20px, 50px); }
  75% { transform: translate(40px, -15px); }
}
/* ======================================= */
/* Aturan ini hanya aktif saat dark mode */
body.dark-mode .animated-icon {
  color: rgba(255, 255, 255, 0.9); /* <-- Warna putih saat dark mode */
}
  </style>
</head>
<body>
<script>
    // Langsung cek tema saat halaman dimuat untuk mencegah kedip
    if (localStorage.getItem('theme') === 'dark') {
      document.body.classList.add('dark-mode');
    }
  </script>
  <!-- LOGIN SCREEN -->
  <div id="loginScreen">
    <div id="loginBox">
      <h4 class="text-primary fw-bold mb-2 text-center">Selamat Datang di Aplikasi EPPGBM</h4>
      <form id="loginForm">
        <div class="mb-3">
          <label class="form-label">Nama Lengkap</label>
          <input id="loginNama" class="form-control" required placeholder="Masukkan nama Anda">
        </div>
        <div class="mb-3">
          <label class="form-label">Jenis Kelamin</label>
          <div class="d-flex gap-3">
            <div><input type="radio" name="gender" id="gL" value="L"> <label for="gL">Laki-laki</label></div>
            <div><input type="radio" name="gender" id="gP" value="P"> <label for="gP">Perempuan</label></div>
          </div>
        </div>
        <button class="btn btn-primary w-100" type="submit">Mulai</button>
      </form>
    </div>
  </div>

  <!-- MAIN APP (hidden until login) -->
  <div id="mainApp" class="container py-3" style="display:none;">
  
  <div class="top-bar">
    <h5 class="fw-bold">EPPGBM</h5>
    <button id="theme-toggle" class="btn btn-sm btn-outline-secondary">
      <i class="bi bi-moon-fill"></i>
    </button>
  </div>

    <p class="mt-2">Halo, <b id="userGreeting">Ibu/Pak</b> 👋</p>

    <!-- Info -->
    <div class="info-box mb-3">
  <div id="iconAnimationArea"></div>

  <div class="info-box-content">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <div class="small">Total Balita</div>
        <div class="h5 m-0" id="totalBalita">0</div>
      </div>
      <div style="width:140px">
        <canvas id="donutMain"></canvas>
      </div>
    </div>
    <div id="chartLegend" class="mt-3"></div>
  </div>
</div>

    <!-- Menu -->
    <div class="row g-3 mb-3">
      <div class="col-6">
        <div class="menu-card" id="btnTambahBalita"><i class="bi bi-plus-circle fs-3"></i><div class="small mt-1">Tambah Data Balita</div></div>
      </div>
      <div class="col-6">
        <div class="menu-card" id="openDataBalita"><i class="bi bi-people fs-3"></i><div class="small mt-1">Data Balita</div></div>
      </div>
    </div>

    <!-- Recent list -->
    <div id="dataContainer"></div>

    <!-- Bottom nav -->
    <div class="bottom-nav">
  <a class="text-center active"><i class="bi bi-house-door"></i><div style="font-size:12px">Home</div></a>
  <a class="text-center"><i class="bi bi-book"></i><div style="font-size:12px">Panduan Gizi</div></a>
  <a class="text-center" id="btnAkun"><i class="bi bi-person"></i><div style="font-size:12px">Akun</div></a>
</div>
  </div>

  <!-- MODAL: Tambah/Edit Balita -->
  <div class="modal fade" id="modalTambahBalita" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <form id="formBalita">
          <div class="modal-header">
            <h5 class="modal-title" id="modalTitle">Tambah Data Balita</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="balitaId">
            <div class="mb-2"><input id="inpNama" class="form-control" placeholder="Nama Balita" required></div>
            <div class="mb-2"><input id="inpNIK" class="form-control" placeholder="NIK" required></div>
            <div class="mb-2"><input id="inpIbu" class="form-control" placeholder="Nama Ibu" required></div>
            <div class="mb-2">
              <label class="form-label small">Jenis Kelamin</label>
              <select id="inpJK" class="form-select">
                <option value="L">Laki-laki</option>
                <option value="P">Perempuan</option>
              </select>
            </div>
            <div class="mb-2"><input id="inpTglLahir" type="date" class="form-control" placeholder="Tanggal Lahir"></div>
            <div class="mb-2"><input id="inpAlamat" class="form-control" placeholder="Alamat (opsional)"></div>
            <hr>
            <div class="small text-muted mb-2">Pengukuran Terakhir</div>
            <div class="mb-2"><input id="inpUmur" type="number" class="form-control" placeholder="Umur (bulan)" required></div>
            <div class="mb-2"><input id="inpBB" type="number" step="0.1" class="form-control" placeholder="Berat Badan (kg)" required></div>
            <div class="mb-2"><input id="inpTB" type="number" step="0.1" class="form-control" placeholder="Tinggi/Panjang (cm)" required></div>
            <div class="mb-2">
                <label class="form-label small">Status Gizi (otomatis)</label>
                <input id="inpStatus" class="form-control" placeholder="Otomatis berdasarkan BB, TB, dan Umur" readonly>
                </div>

            <div class="form-text small">Catatan: Ini data hanya sementara, jika logout atau aplikasi ditutup maka semua akan terhapus.</div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
            <button type="submit" class="btn btn-primary" id="saveBalitaBtn">Simpan</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal Hasil Status Gizi -->
<div class="modal fade" id="modalStatusGizi" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center p-3">
      <div class="modal-body">
        <i class="bi bi-heart-pulse text-primary fs-1 mb-2"></i>
        <h5 id="statusGiziNama" class="fw-semibold mb-2"></h5>
        <p id="statusGiziText" class="fs-6"></p>
      </div>
      <div class="modal-footer border-0">
        <button class="btn btn-primary w-100" data-bs-dismiss="modal">OK</button>
      </div>
    </div>
  </div>
</div>


  <!-- MODAL: Data Balita (list + search/filter) -->
  <div class="modal fade" id="modalDataBalita" tabindex="-1">
    <div class="modal-dialog modal-dialog-scrollable modal-fullscreen-sm-down">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Data Balita</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="d-flex gap-2 mb-3">
            <input id="searchInput" class="form-control" placeholder="Cari nama atau nama ibu...">
            <select id="filterStatus" class="form-select" style="max-width:160px">
              <option value="">Semua Status</option>
              <option value="Baik">Baik</option>
              <option value="Kurang">Kurang</option>
              <option value="Buruk">Buruk</option>
            </select>
          </div>
          <div id="listBalita" class="row g-3"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Detail Balita + KMS tabs -->
  <div class="modal fade" id="modalDetailBalita" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="detailTitle">Detail Balita</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div id="detailInfo" class="mb-3"></div>

          <ul class="nav nav-tabs" id="kmsTabs" role="tablist">
            <li class="nav-item" role="presentation"><button class="nav-link active" id="bbu-tab" data-bs-toggle="tab" data-bs-target="#bbu" type="button">BB / Umur</button></li>
            <li class="nav-item" role="presentation"><button class="nav-link" id="tbu-tab" data-bs-toggle="tab" data-bs-target="#tbu" type="button">TB / Umur</button></li>
            <li class="nav-item" role="presentation"><button class="nav-link" id="bbtb-tab" data-bs-toggle="tab" data-bs-target="#bbtb" type="button">BB / TB</button></li>
          </ul>

          <div class="tab-content mt-3">
            <div class="tab-pane fade show active" id="bbu">
              <canvas id="chartBBU" height="220"></canvas>
              <div class="kms-legend">
                <span style="background:#d1f7d6">Zona Baik (≥ -2SD)</span>
                <span style="background:#fff4cc">Zona Kurang (-3SD ≤ z &lt; -2SD)</span>
                <span style="background:#ffd6d6">Zona Buruk (&lt; -3SD)</span>
              </div>
            </div>
            <div class="tab-pane fade" id="tbu">
              <canvas id="chartTBU" height="220"></canvas>
            </div>
            <div class="tab-pane fade" id="bbtb">
              <canvas id="chartBBTB" height="220"></canvas>
            </div>
          </div>

        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Akun -->
  <div class="modal fade" id="modalAkun" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Akun Saya</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <p><b>Nama:</b> <span id="akunNama">-</span></p>
          <p><b>Jenis Kelamin:</b> <span id="akunGender">-</span></p>
          <hr>
          <button id="btnLogout" class="btn btn-danger w-100">Logout</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalPanduanGizi" tabindex="-1">
  <div class="modal-dialog modal-dialog-scrollable modal-fullscreen-sm-down">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Panduan Gizi Balita</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label">Pilih Umur Balita</label>
          <select id="selectUmurGizi" class="form-select">
            <option value="0-6">0-6 Bulan</option>
            <option value="6-12">6-12 Bulan</option>
            <option value="12-24">1-2 Tahun</option>
            <option value="24-36">2-3 Tahun</option>
            <option value="36-60">3-5 Tahun</option>
          </select>
        </div>
        <div id="infoGizi" class="mb-3 p-3 border rounded bg-light"></div>
        <div id="menuGizi" class="mb-3 p-3 border rounded bg-light"></div>
        <div id="tipsGizi" class="mb-3 p-3 border rounded bg-light"></div>
        <div id="tandaBahayaGizi"class="mb-3 p-3 border rounded bg-light"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary w-100" data-bs-dismiss="modal">Tutup</button>
      </div>
    </div>
  </div>
</div>

<script>



/*
  Full integrated app (client-side, sessionStorage).
  KMS charts use simplified illustrative reference curves.
  For clinical accuracy, replace with WHO LMS data per sex & age.
*/

// --- State & session load
let dataBalita = JSON.parse(sessionStorage.getItem('dataBalita') || '[]');
if(!Array.isArray(dataBalita)) dataBalita = [];

const loginScreen = document.getElementById('loginScreen');
const mainApp = document.getElementById('mainApp');
const loginForm = document.getElementById('loginForm');
const loginNama = document.getElementById('loginNama');

const userGreeting = document.getElementById('userGreeting');

const btnTambahBalita = document.getElementById('btnTambahBalita');
const openDataBalita = document.getElementById('openDataBalita');
const modalTambah = new bootstrap.Modal(document.getElementById('modalTambahBalita'));
const modalData = new bootstrap.Modal(document.getElementById('modalDataBalita'));
const modalDetail = new bootstrap.Modal(document.getElementById('modalDetailBalita'));
const modalAkun = new bootstrap.Modal(document.getElementById('modalAkun'));

const formBalita = document.getElementById('formBalita');
const idEl = document.getElementById('balitaId');
const inpNama = document.getElementById('inpNama');
const inpNIK = document.getElementById('inpNIK');
const inpIbu = document.getElementById('inpIbu');
const inpJK = document.getElementById('inpJK');
const inpTglLahir = document.getElementById('inpTglLahir');
const inpAlamat = document.getElementById('inpAlamat');
const inpUmur = document.getElementById('inpUmur');
const inpBB = document.getElementById('inpBB');
const inpTB = document.getElementById('inpTB');
const inpStatus = document.getElementById('inpStatus');

const listBalitaEl = document.getElementById('listBalita');
const dataContainer = document.getElementById('dataContainer');
const totalBalitaEl = document.getElementById('totalBalita');
const searchInput = document.getElementById('searchInput');
const filterStatus = document.getElementById('filterStatus');

const btnAkun = document.getElementById('btnAkun');
const akunNama = document.getElementById('akunNama');
const akunGender = document.getElementById('akunGender');
const btnLogout = document.getElementById('btnLogout');

// Donut main chart
const donutCtx = document.getElementById('donutMain').getContext('2d');

// Daftarkan plugin datalabels
Chart.register(ChartDataLabels);

const donutChart = new Chart(donutCtx, {
  type: 'doughnut',
  data: {
    labels: ['Baik', 'Kurang', 'Buruk'],
    datasets: [{
      data: [0, 0, 0],
      backgroundColor: ['#198754', '#ffc107', '#dc3545'],
      borderWidth: 0
    }]
  },
  options: {
    // UBAH NILAI CUTOUT DI SINI UNTUK MENGATUR KETEBALAN
    cutout: '60%', // Anda bisa coba '55%' atau '50%' jika ingin lebih tebal
    plugins: {
      legend: {
        display: false
      },
      datalabels: {
        color: '#fff',
        font: {
          weight: 'bold',
          size: 14
        },
        formatter: (value, context) => {
          const datapoints = context.chart.data.datasets[0].data;
          const total = datapoints.reduce((total, datapoint) => total + datapoint, 0);
          const percentage = (value / total) * 100;
          return percentage > 0 ? percentage.toFixed(0) + '%' : '';
        }
        // Properti 'align' dan 'offset' sudah dihapus dari sini
      }
    }
  }
});

// helper
function persist(){ sessionStorage.setItem('dataBalita', JSON.stringify(dataBalita)); }
function uid(){ return 'b'+Date.now().toString(36)+Math.random().toString(36).slice(2,6); }
function badgeFor(status){
  if(status==='Baik') return '<span class="badge-status-b">Baik</span>';
  if(status==='Kurang') return '<span class="badge-status-k">Kurang</span>';
  return '<span class="badge-status-r">Buruk</span>';
}

// --- Login handling
window.addEventListener('load', ()=> {
  loginScreen.classList.add('visible');
  const storedName = sessionStorage.getItem('userName');
  const storedGender = sessionStorage.getItem('userGender');
  if(storedName && storedGender){
    showDashboard(storedName, storedGender);
  } else {
    // keep login visible
  }
});

loginForm.addEventListener('submit', (e)=>{
  e.preventDefault();
  const name = loginNama.value.trim();
  const gender = document.querySelector("input[name='gender']:checked")?.value;
  if(!name || !gender) return alert('Lengkapi nama dan gender!');
  sessionStorage.setItem('userName', name);
  sessionStorage.setItem('userGender', gender);
  showDashboard(name, gender);
});

function showDashboard(name, gender){
  const prefix = gender === 'L' ? 'Pak' : 'Bu';
  userGreeting.innerText = `${prefix} ${name}`;
  // fade out login
  loginScreen.style.opacity = '0';
  setTimeout(()=>{
    loginScreen.style.display = 'none';
    mainApp.style.display = 'block';
    renderHomeList();
    updateStats();
  }, 600);
}

// --- Account modal + logout
btnAkun.addEventListener('click', ()=>{
  const name = sessionStorage.getItem('userName') || '-';
  const gender = sessionStorage.getItem('userGender') === 'L' ? 'Laki-laki' : 'Perempuan';
  akunNama.innerText = name; akunGender.innerText = gender;
  modalAkun.show();
});

btnLogout.addEventListener('click', ()=>{
  // clear session; go back to login
  sessionStorage.clear();
  location.reload();
});

// --- Home list render (recent) with Categories and Auto-Scroll
// --- Home list render (recent) with Categories
function renderHomeList() {
  const dataContainer = document.getElementById('dataContainer');
  dataContainer.innerHTML = '';

  const categories = [
    { name: 'Baik', data: dataBalita.filter(b => b.status === 'Baik') },
    { name: 'Kurang', data: dataBalita.filter(b => b.status === 'Kurang') },
    { name: 'Buruk', data: dataBalita.filter(b => b.status === 'Buruk') }
  ];

  categories.forEach(cat => {
    const section = document.createElement('div');
    section.className = 'category-section';
    
    let contentHtml = '';
    if (cat.data.length === 0) {
      contentHtml = `<div class="empty-state-category">BELUM ADA DATA STATUS GIZI ${cat.name.toUpperCase()}</div>`;
    } else {
      let cardsHtml = cat.data.map(b => `
        <div class="balita-card d-flex align-items-center">
          <div class="card-info-block"> 
            <div class="fw-bold">${b.nama} ${badgeFor(b.status)}</div>
            <div class="small text-muted">Ibu: ${b.ibu} • Umur: ${b.umur} bln</div>
            <div class="small text-muted mt-1">BB: ${b.bb} kg • TB: ${b.tb} cm</div>
          </div>
          <div class="d-flex flex-column justify-content-center gap-2">
            <button class="btn btn-sm btn-outline-primary" onclick="viewDetail('${b.id}')"><i class="bi bi-eye"></i></button>
            <button class="btn btn-sm btn-outline-secondary" onclick="startEdit('${b.id}')"><i class="bi bi-pencil"></i></button>
          </div>
        </div>
      `).join('');
      
      contentHtml = `
        <div class="carousel-wrapper">
          <div class="carousel-track">
            ${cardsHtml}
          </div>
        </div>
      `;
    }
    
    section.innerHTML = `<h6 class="category-title">${cat.name}</h6>` + contentHtml;
    dataContainer.appendChild(section);
  });

  setupCarousels();
}

// --- Stats update
// --- Stats update with Icon Animation
function updateStats() {
  const total = dataBalita.length;
  totalBalitaEl.innerText = total;

  // === BAGIAN BARU UNTUK MEMBUAT IKON ANIMASI ===
  const animationArea = document.getElementById('iconAnimationArea');
  animationArea.innerHTML = ''; // Kosongkan ikon lama
  
  for (let i = 0; i < total; i++) {
    const icon = document.createElement('i');
    icon.className = 'bi bi-emoji-smile-fill animated-icon';
    
    // Buat posisi, ukuran, dan kecepatan acak agar terlihat natural
    icon.style.left = `${Math.random() * 85}%`;
    icon.style.top = `${Math.random() * 80}%`;
    icon.style.fontSize = `${18 + Math.random() * 20}px`;
    icon.style.opacity = 0.1 + Math.random() * 0.15;
    icon.style.animationDuration = `${15 + Math.random() * 10}s`;
    icon.style.animationDelay = `${Math.random() * 15}s`;
    
    animationArea.appendChild(icon);
  }
  // ===========================================

  const baik = dataBalita.filter(x => x.status === 'Baik').length;
  const kurang = dataBalita.filter(x => x.status === 'Kurang').length;
  const buruk = dataBalita.filter(x => x.status === 'Buruk').length;

  donutChart.data.datasets[0].data = [baik, kurang, buruk];
  donutChart.update();

  const legendContainer = document.getElementById('chartLegend');
  if (total > 0) {
    legendContainer.innerHTML = `
      <div class="row text-center mt-2 gx-1">
        <div class="col-4">
          <div class="legend-item-horiz">
            <span class="legend-label"><span class="legend-dot" style="background:#198754;"></span>Baik</span>
            <div class="legend-value">${baik}</div>
          </div>
        </div>
        <div class="col-4">
          <div class="legend-item-horiz">
            <span class="legend-label"><span class="legend-dot" style="background:#ffc107;"></span>Kurang</span>
            <div class="legend-value">${kurang}</div>
          </div>
        </div>
        <div class="col-4">
          <div class="legend-item-horiz">
            <span class="legend-label"><span class="legend-dot" style="background:#dc3545;"></span>Buruk</span>
            <div class="legend-value">${buruk}</div>
          </div>
        </div>
      </div>
    `;
  } else {
    legendContainer.innerHTML = '';
  }
}

// --- Modal: open add
btnTambahBalita.addEventListener('click', ()=>{
  idEl.value=''; formBalita.reset(); document.getElementById('modalTitle').innerText = 'Tambah Data Balita';
  modalTambah.show();
});

// --- Modal: open list
openDataBalita.addEventListener('click', ()=>{ renderListModal(); modalData.show(); });

function hitungStatusGizi(bb, tb, umur, jk='L') {
  // contoh median sederhana untuk demo (bulan 0–11)
  const medianBB = jk==='L' ? [2.5,4.4,5.6,6.4,7.0,7.5,7.9,8.3,8.6,8.9,9.2,9.4]
                            : [2.4,4.2,5.1,5.8,6.4,6.9,7.3,7.6,7.9,8.2,8.4,8.6];
  const medianTB = jk==='L' ? [49,53,57,61,64,67,70,72,74,76,78,80]
                            : [48,52,56,59,62,65,67,69,71,73,75,77];

  const index = Math.min(Math.floor(umur),11);
  const bbStatus = bb/medianBB[index] < 0.7 ? 'Buruk'
                  : bb/medianBB[index] < 0.8 ? 'Kurang'
                  : 'Baik';
  const tbStatus = tb/medianTB[index] < 0.7 ? 'Buruk'
                  : tb/medianTB[index] < 0.8 ? 'Kurang'
                  : 'Baik';
  const bbtbRatio = bb/tb; // sederhana
  const bbtbStatus = bbtbRatio < 0.08 ? 'Buruk'
                   : bbtbRatio < 0.1 ? 'Kurang'
                   : 'Baik';
  
  // overall: ambil terburuk dari ketiganya
  const overall = [bbStatus,tbStatus,bbtbStatus].includes('Buruk') ? 'Buruk'
                 : [bbStatus,tbStatus,bbtbStatus].includes('Kurang') ? 'Kurang'
                 : 'Baik';

  return { bbStatus, tbStatus, bbtbStatus, overall };
}

// --- Panduan Gizi
const btnPanduanGizi = document.querySelector(".bottom-nav a:nth-child(2)");
const modalPanduan = new bootstrap.Modal(document.getElementById('modalPanduanGizi'));
const selectUmurGizi = document.getElementById('selectUmurGizi');
const infoGizi = document.getElementById('infoGizi');
const menuGizi = document.getElementById('menuGizi');
const tipsGizi = document.getElementById('tipsGizi');

const giziData = {
  "0-6": {
    energi: "550 kkal/hari",
    lemak: "30-31 g/hari",
    karbo: "65-70 g/hari",
    protein: "9-11 g/hari",
    menu: "🌅 Sarapan • ASI eksklusif\n🍎 Snack Pagi • ASI\n☀️ Makan Siang • ASI\n🍇 Snack Sore • ASI\n🌙 Makan Malam • ASI\n📝 Catatan: Fokus pada ASI eksklusif",
    tips: "Berikan ASI sesuai permintaan, hindari air/MPASI sebelum 6 bulan",
    tandaBahaya: "berat badan tidak naik, sering sakit, lesu."
  },
  "6-12": {
    energi: "700 kkal/hari",
    lemak: "30-35 g/hari",
    karbo: "95-100 g/hari",
    protein: "11-13 g/hari",
    menu: "🌅 Sarapan • ASI + bubur saring\n🍎 Snack Pagi • Puree buah + ASI\n☀️ Makan Siang • Bubur tim + sayuran + daging\n🍇 Snack Sore • ASI\n🌙 Makan Malam • Bubur tim + sayuran + ASI\n📝 Catatan: MPASI bertahap, perkenalkan berbagai rasa dan tekstur",
    tips: "Berikan protein hewani/ nabati seimbang", 
    tandaBahaya: "muntah terus-menerus, diare berkepanjangan, berat badan tidak naik."
  },
  "12-24": {
    energi: "1000 kkal/hari",
    lemak: "35 g/hari",
    karbo: "130 g/hari",
    protein: "15 g/hari",
    menu: "🌅 Sarapan • Bubur + susu\n🍎 Snack Pagi • Buah potong + air\n☀️ Makan Siang • Nasi tim + lauk + sayur\n🍇 Snack Sore • Yogurt atau ASI\n🌙 Makan Malam • Nasi + lauk + sayur\n📝 Catatan: Variasikan menu, perkenalkan finger food",
    tips: "Protein: telur, ikan, daging cincang.", 
    tandaBahaya: "lemas, sering sakit, pertumbuhan terhambat."
  },
  "24-36": {
    energi: "1200 kkal/hari",
    lemak: "40 g/hari",
    karbo: "150 g/hari",
    protein: "18 g/hari",
    menu: "🌅 Sarapan • Roti + telur\n🍎 Snack Pagi • Buah potong\n☀️ Makan Siang • Nasi + lauk + sayur\n🍇 Snack Sore • Susu / yogurt\n🌙 Makan Malam • Nasi + lauk + sayur\n📝 Catatan: Perkenalkan makanan keluarga, awasi porsi",
    tips: "Protein: ayam, ikan, kacang-kacangan.", 
    tandaBahaya: "malas makan, kurang aktivitas, pertumbuhan melambat."
  },
  "36-60": {
    energi: "1500 kkal/hari",
    lemak: "45 g/hari",
    karbo: "180 g/hari",
    protein: "25 g/hari",
    menu: "🌅 Sarapan • Sereal + susu\n🍎 Snack Pagi • Buah / kacang\n☀️ Makan Siang • Nasi + lauk + sayur\n🍇 Snack Sore • Susu / yogurt\n🌙 Makan Malam • Nasi + lauk + sayur\n📝 Catatan: Makanan keluarga, variasikan menu, hindari junk food",
    tips: "Protein: ayam, ikan, telur, tempe/tahu.", 
    tandaBahaya: "lemas, nafsu makan rendah, tumbuh tidak optimal."
  }
};

function renderPanduan(umurKey){
  const data = giziData[umurKey];
  infoGizi.innerHTML = `<b>Kebutuhan Harian:</b><br>Energi: ${data.energi}<br>Lemak: ${data.lemak}<br>Karbohidrat: ${data.karbo}<br>Protein: ${data.protein}`;
  menuGizi.innerHTML = `<b>Contoh Menu Harian:</b><pre>${data.menu}</pre>`;
  tipsGizi.innerHTML = `<b>Tips Pemberian Makan:</b><pre>${data.tips}</pre>`;
  tandaBahayaGizi.innerHTML = `<b>Tanda Bahaya:</b><pre>${data.tandaBahaya}</pre>`;
}

// init default
renderPanduan(selectUmurGizi.value);

selectUmurGizi.addEventListener('change', ()=> renderPanduan(selectUmurGizi.value));

// open modal via bottom nav
btnPanduanGizi.addEventListener('click', ()=> modalPanduan.show());



// --- Form save (add/edit)
formBalita.addEventListener('submit', (e)=>{
  e.preventDefault();
  const nama = inpNama.value.trim();
  const nik = inpNIK.value.trim();
  if(!nama || !nik) return alert('Nama & NIK minimal harus diisi');

  const jk = inpJK.value;
  const umur = parseInt(inpUmur.value||0,10);
  const bb = parseFloat(inpBB.value||0);
  const tb = parseFloat(inpTB.value||0);

  // 🔥 hitung otomatis status gizi
  const statusObj = hitungStatusGizi(bb, tb, umur, jk);
inpStatus.value = statusObj.overall; // tampilkan overall di field

const rec = {
  id: idEl.value || uid(),
  nama,
  nik,
  ibu: inpIbu.value.trim(),
  jk,
  tanggalLahir: inpTglLahir.value || null,
  alamat: inpAlamat.value || '',
  umur,
  bb,
  tb,
  status: statusObj.overall,
  bbStatus: statusObj.bbStatus,
  tbStatus: statusObj.tbStatus,
  bbtbStatus: statusObj.bbtbStatus
};

  const idx = dataBalita.findIndex(x=>x.id===rec.id);
  if(idx>=0) dataBalita[idx] = rec; else dataBalita.push(rec);
  persist(); updateStats(); renderHomeList();
  modalTambah.hide();

  // ✅ Popup hasil status gizi
  // ✅ Popup hasil status gizi (pakai modal)
setTimeout(() => {
  document.getElementById('statusGiziNama').innerText = `Balita ${nama}`;
  document.getElementById('statusGiziText').innerHTML = `
    <b>Status Keseluruhan:</b> ${statusObj.overall}<br>
    <b>BB/U:</b> ${statusObj.bbStatus}<br>
    <b>TB/U:</b> ${statusObj.tbStatus}<br>
    <b>BB/TB:</b> ${statusObj.bbtbStatus}
  `;
  const modalStatusGizi = new bootstrap.Modal(document.getElementById('modalStatusGizi'));
  modalStatusGizi.show();
}, 300);


});


// --- Render list modal (search & filter)
function renderListModal(){
  const q = (searchInput?.value||'').toLowerCase();
  const f = (filterStatus?.value||'');
  const filtered = dataBalita.filter(b=>{
    const matchQ = !q || (b.nama||'').toLowerCase().includes(q) || (b.ibu||'').toLowerCase().includes(q);
    const matchF = !f || b.status===f;
    return matchQ && matchF;
  });
  const container = listBalitaEl;
  container.innerHTML = filtered.length ? filtered.map(b=>{
    return `
      <div class="col-12">
        <div class="balita-card d-flex justify-content-between align-items-start">
          <div>
            <div class="fw-bold">${b.nama} ${badgeFor(b.status)}</div>
            <div class="small text-muted">NIK: ${b.nik} • Ibu: ${b.ibu}</div>
            <div class="small text-muted mt-1">Umur: ${b.umur} bln • BB: ${b.bb} kg • TB: ${b.tb} cm</div>
          </div>
          <div class="text-end">
            <button class="btn btn-sm btn-primary mb-1" onclick="viewDetail('${b.id}')">Lihat Detail</button><br/>
            <button class="btn btn-sm btn-outline-secondary" onclick="startEdit('${b.id}')">Edit</button>
          </div>
        </div>
      </div>
    `;
  }).join('') : '<div class="text-muted small">Tidak ada data.</div>';
}

document.addEventListener('input', (e)=>{
  if(e.target && (e.target.id==='searchInput' || e.target.id==='filterStatus')) renderListModal();
});
// --- Edit start
function startEdit(id){
  // 1. Sembunyikan dulu modal daftar balita
  modalData.hide();

  // 2. Tunggu 400 milidetik agar animasi penutupan modal pertama selesai
  setTimeout(() => {
    const b = dataBalita.find(x=>x.id===id); if(!b) return alert('Data tidak ditemukan');
    
    // Isi semua form dengan data yang akan diedit
    idEl.value = b.id;
    inpNama.value = b.nama; 
    inpNIK.value = b.nik; 
    inpIbu.value = b.ibu; 
    inpJK.value = b.jk || 'L';
    inpTglLahir.value = b.tanggalLahir || ''; 
    inpAlamat.value = b.alamat || '';
    inpUmur.value = b.umur || ''; 
    inpBB.value = b.bb || ''; 
    inpTB.value = b.tb || ''; 
    inpStatus.value = b.status || 'Baik';
    document.getElementById('modalTitle').innerText = 'Edit Data Balita';
    
    // 3. Setelah jeda singkat, baru tampilkan modal edit
    modalTambah.show();
  }, 400); // Jeda 400ms
}

// --- Detail & KMS charts
let chartBBU=null, chartTBU=null, chartBBTB=null;
function viewDetail(id){
  const b = dataBalita.find(x=>x.id===id); if(!b) return;
  document.getElementById('detailTitle').innerText = `Detail — ${b.nama}`;
  document.getElementById('detailInfo').innerHTML = `
    <div class="row">
      <div class="col-8">
        <div><b>Nama:</b> ${b.nama}</div>
        <div class="small text-muted">NIK: ${b.nik}</div>
        <div class="small">Ibu: ${b.ibu}</div>
        <div class="small">Jenis Kelamin: ${b.jk === 'L' ? 'Laki-laki' : 'Perempuan'}</div>
        <div class="small">Tanggal Lahir: ${b.tanggalLahir || '-'}</div>
        <div class="small">Alamat: ${b.alamat || '-'}</div>
      </div>
      <div class="col-4 text-end">
        <div class="small text-muted">Pengukuran terakhir</div>
        <div><b>Umur:</b> ${b.umur} bln</div>
        <div><b>BB:</b> ${b.bb} kg</div>
        <div><b>TB:</b> ${b.tb} cm</div>
        <div class="mt-2">${badgeFor(b.status)}</div>
      </div>
    </div>
  `;

  // ages 0..60
  const ages = Array.from({length:61},(_,i)=>i);

  // simplified median curves for demo
  const medianWeight = ages.map(a => 3.3 + (18-3.3)*(a/60));
  const sdLow3 = medianWeight.map(m=> m*0.65);
  const sdLow2 = medianWeight.map(m=> m*0.80);
  const sdHigh2 = medianWeight.map(m=> m*1.25);
  const sdHigh3 = medianWeight.map(m=> m*1.40);

  const medianHeight = ages.map(a => 50 + (110-50)*(a/60));
  const htLow3 = medianHeight.map(m=> m*0.91);
  const htLow2 = medianHeight.map(m=> m*0.95);
  const htHigh2 = medianHeight.map(m=> m*1.05);
  const htHigh3 = medianHeight.map(m=> m*1.09);

  const heights = medianHeight;
  const medianWforH = heights.map(h => 0.0025*(h*h));
  const wfhLow3 = medianWforH.map(v=> v*0.65);
  const wfhLow2 = medianWforH.map(v=> v*0.80);
  const wfhHigh2 = medianWforH.map(v=> v*1.25);
  const wfhHigh3 = medianWforH.map(v=> v*1.40);

  const childAge = b.umur || 0;
  const childBB = b.bb || 0;
  const childTB = b.tb || 0;

  // BBU
  const ctxBBU = document.getElementById('chartBBU').getContext('2d');
  if(chartBBU) chartBBU.destroy();
  chartBBU = new Chart(ctxBBU, {
    type:'line',
    data:{
      labels: ages,
      datasets:[
        {label:'-3SD', data:sdLow3, borderColor:'#ffd6d6', pointRadius:0, fill:false},
        {label:'-2SD', data:sdLow2, borderColor:'#fff4cc', pointRadius:0, fill:false},
        {label:'Median', data:medianWeight, borderColor:'#198754', borderWidth:2, pointRadius:0, fill:false},
        {label:'+2SD', data:sdHigh2, borderColor:'#cfefff', pointRadius:0, fill:false},
        {label:'+3SD', data:sdHigh3, borderColor:'#cfefff', pointRadius:0, fill:false},
        {label:'Data Balita', data: ages.map(a=> a===childAge?childBB:NaN), borderColor:'#000', backgroundColor:'#000', pointRadius:6, showLine:false}
      ]
    },
    options: {
    responsive: true,
    plugins: {
      legend: { display: false },
      datalabels: { display: false } // <-- TAMBAHKAN INI
    },
    scales: {x:{title:{display:true,text:'Umur (bulan)'}}, y:{title:{display:true,text:'Berat (kg)'}}}
}});

  // TBU
  const ctxTBU = document.getElementById('chartTBU').getContext('2d');
  if(chartTBU) chartTBU.destroy();
  chartTBU = new Chart(ctxTBU, {
    type:'line',
    data:{
      labels: ages,
      datasets:[
        {label:'-3SD', data:htLow3, borderColor:'#ffd6d6', pointRadius:0, fill:false},
        {label:'-2SD', data:htLow2, borderColor:'#fff4cc', pointRadius:0, fill:false},
        {label:'Median', data:medianHeight, borderColor:'#0d6efd', borderWidth:2, pointRadius:0, fill:false},
        {label:'+2SD', data:htHigh2, borderColor:'#cfefff', pointRadius:0, fill:false},
        {label:'+3SD', data:htHigh3, borderColor:'#cfefff', pointRadius:0, fill:false},
        {label:'Data Balita', data: ages.map(a=> a===childAge?childTB:NaN), borderColor:'#000', backgroundColor:'#000', pointRadius:6, showLine:false}
      ]
    },
    options: {
    responsive: true,
    plugins: {
      legend: { display: false },
      datalabels: { display: false } // <-- TAMBAHKAN INI
    },
    scales: {x:{title:{display:true,text:'Umur (bulan)'}}, y:{title:{display:true,text:'Tinggi (cm)'}}}
  }
  });

  // BB/TB
  const ctxBBTB = document.getElementById('chartBBTB').getContext('2d');
  if(chartBBTB) chartBBTB.destroy();
  chartBBTB = new Chart(ctxBBTB, {
    type:'line',
    data:{
      labels: heights.map(h=>Math.round(h)),
      datasets:[
        {label:'-3SD', data:wfhLow3, borderColor:'#ffd6d6', pointRadius:0, fill:false},
        {label:'-2SD', data:wfhLow2, borderColor:'#fff4cc', pointRadius:0, fill:false},
        {label:'Median', data:medianWforH, borderColor:'#198754', borderWidth:2, pointRadius:0, fill:false},
        {label:'+2SD', data:wfhHigh2, borderColor:'#cfefff', pointRadius:0, fill:false},
        {label:'+3SD', data:wfhHigh3, borderColor:'#cfefff', pointRadius:0, fill:false},
        {label:'Data Balita', data: heights.map(h=> (Math.round(h)===Math.round(childTB))?childBB:NaN), borderColor:'#000', backgroundColor:'#000', pointRadius:6, showLine:false}
      ]
    },
    options: {
    responsive: true,
    plugins: {
      legend: { display: false },
      datalabels: { display: false } // <-- TAMBAHKAN INI
    },
    scales: {x:{title:{display:true,text:'Tinggi (cm)'}}, y:{title:{display:true,text:'Berat (kg)'}}}
  }
  });

  modalDetail.show();
}

// --- Init render & bindings
function init() {
  // Setup utama
  updateStats();
  renderHomeList();
  
  // Setup event listener
  document.getElementById('modalDataBalita').addEventListener('shown.bs.modal', renderListModal);
  
  // Expose fungsi ke global scope untuk tombol-tombol di dalam HTML
  window.viewDetail = viewDetail;
  window.startEdit = startEdit;

  // --- LOGIKA DARK MODE --- (HANYA ADA DI DALAM INIT)
  const themeToggle = document.getElementById('theme-toggle');
  const themeIcon = themeToggle.querySelector('i');

  // Set ikon yang benar saat halaman pertama kali dimuat
  if (document.body.classList.contains('dark-mode')) {
    themeIcon.classList.replace('bi-moon-fill', 'bi-sun-fill');
  }

  themeToggle.addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
    
    // Simpan pilihan tema dan ganti ikon
    if (document.body.classList.contains('dark-mode')) {
      localStorage.setItem('theme', 'dark');
      themeIcon.classList.replace('bi-moon-fill', 'bi-sun-fill');
    } else {
      localStorage.setItem('theme', 'light');
      themeIcon.classList.replace('bi-sun-fill', 'bi-moon-fill');
    }
  });
}

// --- Logic untuk Auto-Slide Carousel ---
function setupCarousels() {
  const carousels = document.querySelectorAll('.carousel-wrapper');

  carousels.forEach(carousel => {
    const track = carousel.querySelector('.carousel-track');
    const cards = track.querySelectorAll('.balita-card');
    if (cards.length <= 1) return; // Jangan jalankan jika kartu cuma 1 atau 0

    let currentIndex = 0;
    let intervalId;

    const slideNext = () => {
      currentIndex++;
      if (currentIndex >= cards.length) {
        currentIndex = 0; // Kembali ke awal
      }
      const cardWidth = cards[0].offsetWidth + 10; // Lebar kartu + gap
      track.style.transform = `translateX(-${currentIndex * cardWidth}px)`;
    };

    const startCarousel = () => {
      intervalId = setInterval(slideNext, 5000); // Pindah setiap 5 detik
    };

    const stopCarousel = () => {
      clearInterval(intervalId);
    };

    startCarousel();
    carousel.addEventListener('mouseenter', stopCarousel);
    carousel.addEventListener('mouseleave', startCarousel);
  });
}

// Panggil fungsi init HANYA SEKALI di akhir
init();

</script>
</body>
</html>
